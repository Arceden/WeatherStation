var canvas=document.getElementById("graphs"),ctx=canvas.getContext("2d");canvas.width=800,canvas.height=600;var botswanaIds=["680240","680260","680290","680380","680400","680540","682340","682400","682675"],datathings={};for(var id of botswanaIds){var option=document.createElement("option");option.text=`Station ${id}`,document.getElementById("dropdown").appendChild(option)}var dataRequest=new XMLHttpRequest;dataRequest.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var c=this.responseText.split("\n");datathings={};for(var a,d=1;d<c.length-1;d++)a=c[d].split(";"),datathings[a[0]]={date:a[1],time:a[2],temp:a[3],dewp:a[4],stp:a[5],slp:a[6],visib:a[7],wdsp:a[8],prcp:a[9],sndp:a[10],frshht:a[11],cldc:a[12],wnddir:a[13]}}};var currentStation="Station: 680240";function loop(){window.requestAnimationFrame(loop),ctx.fillStyle="rgb(200, 200, 200)",ctx.fillRect(0,0,canvas.width,canvas.height);var a=currentStation.split(" ")[1];if(botswanaIds.includes(a)&&datathings[a]){ctx.fillStyle="rgb(0, 0, 0)",ctx.font="15px Arial",ctx.fillText(`Date of measurement: ${datathings[a].date} at ${datathings[a].time}`,20,20),ctx.fillText(`Temperature: ${datathings[a].temp}°C`,20,40),ctx.fillText(`Dew point: ${datathings[a].dewp}°C`,20,60),ctx.fillText(`Air pressure at station level: ${datathings[a].stp} millibar`,20,80),ctx.fillText(`Air pressure at sea level: ${datathings[a].slp} millibar`,20,100),ctx.fillText(`Visibility : ${datathings[a].visib} kilometers`,20,120),ctx.fillText(`Wind speed: ${datathings[a].wdsp} km/h`,20,140),ctx.fillText(`Rainfall: ${datathings[a].prcp} cm`,20,160),ctx.fillText(`Snowfall: ${datathings[a].sndp} cm`,20,180),ctx.fillText(`Cloud Cover: ${datathings[a].cldc} %`,20,200),ctx.fillText(`Winddirection: ${datathings[a].wnddir%360} degrees`,20,220);var b=[];32==(32&datathings[a].frshht)&&b.push("freezing"),16==(16&datathings[a].frshht)&&b.push("raining"),8==(8&datathings[a].frshht)&&b.push("snowing"),4==(4&datathings[a].frshht)&&b.push("hailing"),2==(2&datathings[a].frshht)&&b.push("storming"),1==(1&datathings[a].frshht)&&b.push("there are tornadoes");for(var c="It's ",d=!1,e=0;e<b.length-1;e++)c+=b[e]+", ",d=!0;d&&(c+="and "),b.length&&(c+=b[b.length-1]),"It's "!=c&&ctx.fillText(c,20,240)}}loop();function update(){currentStation=document.getElementById("dropdown").value}setInterval(function(){dataRequest.open("GET","smol.csv",!0),dataRequest.send()},1e3);